<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TwCCCC 10 年冠心病風險試算</title>
  <style>
    :root {
      --bg: #f4f6fb;
      --card: #ffffff;
      --accent: #005bbb;
      --text: #1f2933;
      --muted: #6b7280;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    }

    * {
      box-sizing: border-box;
      font-family: "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", system-ui, -apple-system, sans-serif;
    }

    body {
      margin: 0;
      background: linear-gradient(180deg, #f7f9fc 0%, #eef3fb 40%, #e8eef9 100%);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 24px 16px;
    }

    .container {
      width: min(960px, 100%);
      background: var(--card);
      border-radius: 18px;
      box-shadow: var(--shadow);
      padding: clamp(20px, 3vw, 32px);
    }

    header {
      text-align: center;
      margin-bottom: 24px;
    }

    header h1 {
      margin: 0 0 8px;
      font-size: clamp(24px, 4vw, 32px);
      letter-spacing: 0.5px;
    }

    header p {
      margin: 0;
      color: var(--muted);
      font-size: 15px;
      line-height: 1.6;
    }

    form {
      display: grid;
      gap: 16px;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      font-size: 15px;
    }

    .field {
      background: #f9fbff;
      border: 1px solid #dce4f3;
      border-radius: 12px;
      padding: 12px 14px;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
      width: 100%;
      font-size: 16px;
      color: var(--text);
    }

    .field:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(0, 91, 187, 0.15);
    }

    .actions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 8px;
    }

    button {
      border: none;
      border-radius: 12px;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.2s ease, background-color 0.2s ease;
    }

    .primary {
      background: var(--accent);
      color: #fff;
      box-shadow: 0 8px 20px rgba(0, 91, 187, 0.2);
    }

    .primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 24px rgba(0, 91, 187, 0.25);
    }

    .secondary {
      background: #e5edfb;
      color: var(--accent);
      border: 1px solid #d0def7;
    }

    .result-card {
      background: linear-gradient(135deg, #f4f8ff 0%, #ecf2ff 100%);
      border: 1px solid #dbe6ff;
      border-radius: 16px;
      padding: 16px;
      display: grid;
      gap: 12px;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    }

    .result-item {
      padding: 12px;
      border-radius: 12px;
      background: #fff;
      border: 1px solid #e4ebf7;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.04);
    }

    .result-item h3 {
      margin: 0 0 6px;
      font-size: 15px;
      color: var(--muted);
      letter-spacing: 0.2px;
    }

    .result-item .value {
      font-size: 26px;
      font-weight: 800;
      color: var(--accent);
    }

    .risk-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 10px;
      border-radius: 10px;
      font-weight: 700;
      font-size: 15px;
    }

    .risk-low { background: #e6f8ee; color: #0a8a43; border: 1px solid #b4e8c9; }
    .risk-mid { background: #fff8e6; color: #c07a00; border: 1px solid #ffe1a3; }
    .risk-high { background: #ffe8e6; color: #c0392b; border: 1px solid #ffc4be; }

    .note {
      font-size: 13px;
      color: var(--muted);
      line-height: 1.6;
      margin-top: 8px;
    }

    @media (max-width: 640px) {
      body { padding: 16px 12px; }
      .container { padding: 20px 16px; }
    }
  </style>
</head>
<body>
  <main class="container">
    <header>
      <h1>TwCCCC 10 年冠心病風險試算</h1>
      <p>此頁面採用示範公式計算，僅供介面與流程展示。請依您的正式點數表更新計算邏輯。</p>
    </header>

    <form id="risk-form" novalidate>
      <div>
        <label for="gender">性別</label>
        <select id="gender" name="gender" class="field" required>
          <option value="">請選擇</option>
          <option value="male">男</option>
          <option value="female">女</option>
        </select>
      </div>

      <div>
        <label for="age">年齡（歲）</label>
        <input id="age" name="age" class="field" type="number" min="18" max="120" step="1" placeholder="例如：45" required>
      </div>

      <div>
        <label for="bmi">BMI</label>
        <input id="bmi" name="bmi" class="field" type="number" min="10" max="60" step="0.1" placeholder="例如：23.5" required>
      </div>

      <div>
        <label for="sbp">收縮壓（SBP，mmHg）</label>
        <input id="sbp" name="sbp" class="field" type="number" min="80" max="260" step="1" placeholder="例如：120" required>
      </div>

      <div>
        <label for="ldl">LDL（mg/dL）</label>
        <input id="ldl" name="ldl" class="field" type="number" min="30" max="300" step="1" placeholder="例如：110" required>
      </div>

      <div>
        <label for="hdl">HDL（mg/dL）</label>
        <input id="hdl" name="hdl" class="field" type="number" min="10" max="150" step="1" placeholder="例如：50" required>
      </div>
    </form>

    <div class="actions">
      <button id="calculate" class="primary" type="button">計算風險</button>
      <button id="reset" class="secondary" type="button">清除資料</button>
    </div>

    <section class="result-card" aria-live="polite">
      <div class="result-item">
        <h3>TwCCCC 總分</h3>
        <div class="value" id="score-display">--</div>
      </div>
      <div class="result-item">
        <h3>預估 10 年風險</h3>
        <div class="value" id="risk-display">--</div>
      </div>
      <div class="result-item">
        <h3>風險分級</h3>
        <div id="risk-level" class="risk-badge risk-low">請先計算</div>
      </div>
    </section>

    <p class="note">示範公式：依性別、年齡、BMI、收縮壓、LDL、HDL 生成暫用點數並換算百分比；實務上請代入官方 TwCCCC 點數表與對應風險機率。</p>
  </main>

  <script>
    const form = document.getElementById('risk-form');
    const calculateBtn = document.getElementById('calculate');
    const resetBtn = document.getElementById('reset');
    const scoreDisplay = document.getElementById('score-display');
    const riskDisplay = document.getElementById('risk-display');
    const riskLevel = document.getElementById('risk-level');

    const getNumber = (id) => {
      const value = parseFloat(document.getElementById(id).value);
      return Number.isFinite(value) ? value : null;
    };

    const validate = () => {
      const requiredIds = ['gender', 'age', 'bmi', 'sbp', 'ldl', 'hdl'];
      let valid = true;
      requiredIds.forEach((id) => {
        const input = document.getElementById(id);
        if (!input.value) {
          input.focus();
          valid = false;
        }
      });
      return valid;
    };

    const placeholderCalculation = () => {
      const gender = document.getElementById('gender').value;
      const age = getNumber('age');
      const bmi = getNumber('bmi');
      const sbp = getNumber('sbp');
      const ldl = getNumber('ldl');
      const hdl = getNumber('hdl');

      if ([gender, age, bmi, sbp, ldl, hdl].includes(null) || !gender) {
        return null;
      }

      // 示範點數：請替換為正式 TwCCCC 權重
      const genderPoints = gender === 'male' ? 5 : 0;
      const agePoints = (age - 20) * 0.4;
      const bmiPoints = (bmi - 18.5) * 0.6;
      const sbpPoints = (sbp - 110) * 0.12;
      const ldlPoints = (ldl - 70) * 0.08;
      const hdlPoints = (50 - hdl) * 0.15;

      const totalScore = Math.max(0, Math.round(genderPoints + agePoints + bmiPoints + sbpPoints + ldlPoints + hdlPoints));

      // 示範風險百分比：可替換為實際風險表
      const estimatedRisk = Math.min(50, Math.max(1, (totalScore * 0.9 + 3))).toFixed(1);

      return { totalScore, estimatedRisk: Number(estimatedRisk) };
    };

    const renderRiskLevel = (risk) => {
      let label = '低風險';
      let cls = 'risk-low';

      if (risk >= 20) {
        label = '高風險';
        cls = 'risk-high';
      } else if (risk >= 10) {
        label = '中風險';
        cls = 'risk-mid';
      }

      riskLevel.textContent = `${label}（示範閾值：<10% 低、10-19% 中、≥20% 高）`;
      riskLevel.className = `risk-badge ${cls}`;
    };

    const calculate = () => {
      if (!validate()) {
        alert('請完整填寫所有欄位');
        return;
      }

      const result = placeholderCalculation();
      if (!result) return;

      scoreDisplay.textContent = `${result.totalScore} 分`;
      riskDisplay.textContent = `${result.estimatedRisk}%`;
      renderRiskLevel(result.estimatedRisk);
    };

    const resetForm = () => {
      form.reset();
      scoreDisplay.textContent = '--';
      riskDisplay.textContent = '--';
      riskLevel.textContent = '請先計算';
      riskLevel.className = 'risk-badge risk-low';
    };

    calculateBtn.addEventListener('click', calculate);
    resetBtn.addEventListener('click', resetForm);

    form.addEventListener('keydown', (event) => {
      if (event.key === 'Enter') {
        event.preventDefault();
        calculate();
      }
    });
  </script>
</body>
</html>
